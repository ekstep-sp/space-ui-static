<mat-toolbar [color]="pageNavbar.color">
    <ws-widget-btn-page-back [widgetData]="{ url: '/app/user-dashboard' }"></ws-widget-btn-page-back>
    <span class="margin-left-xs text-truncate span-class">
        <span class="visible-xs-inline nav-bar-style" i18n>Migrate Content</span>
    </span>
</mat-toolbar>

<div class="py-12">

    <div *ngIf="(isLoading$ | async)" class ="flex justify-center ">
        <ng-container  *ngTemplateOutlet="spinner"></ng-container>
    </div>
    <ng-container *ngIf="!(isLoading$ | async) && !(isSuccess$ | async) && !(isError$ | async)">
        <div class="flex flex-col">
            <div class ="p-5 flex items-center justify-center flex-col md:flex-row">
                <h1 class ="flex text-8xl items-center text-center md:text-left">Migrate {{sourceUser?.name}}'s content to </h1>
                <mat-form-field appearance="outline" class="p-4 form-style">
                    <mat-label>Select Content Creator</mat-label>
                    <mat-select [(value)]="targetUser" [disabled]="isDisabled$ | async" >
                        <mat-option *ngFor="let user of (userList$ | async)" [value]="user">
                        {{user?.first_name}} {{user?.last_name}} 
                        <ng-container *ngIf="user?.department_name">
                        | {{user?.department_name}}
                        </ng-container>
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
    
            <div class="flex justify-center py-32" *ngIf="targetUser">
                <div>
                    <p class="mb-12">Are you sure to migrate content?</p>
                    <div class="flex justify-around max-270">
                        <button mat-flat-button  color="primary" (click)="acceptContentMigration()">Yes</button>
                        <a mat-stroked-button  (click)="rejectContentMigration()">No</a>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
    
    <ng-container *ngIf="!(isLoading$ | async) && (isSuccess$ | async) && targetUser" >
        <div class="flat-alert-success">
            {{sourceUser?.name}}'s content has been migrated to {{targetUser?.first_name}} {{targetUser?.last_name}} successfully
        </div>
        <div class="go-back-container" >
            <button mat-button mat-raised-button type="button" color="primary" routerLink="/app/user-dashboard">
                Go back
            </button>
        </div>
        </ng-container>
    <ng-container *ngIf="!(isLoading$ | async) && (isError$ | async) && targetUser" >
        <div class="flat-alert-error">
            Error occured while migrating the content of {{sourceUser?.name}} to {{targetUser?.first_name}} {{targetUser?.last_name}}, try again later
        </div>
        <div class="go-back-container">
            <button mat-button mat-raised-button type="button" color="primary" routerLink="/app/user-dashboard">
                Go back
            </button>
        </div>
    </ng-container>

</div>

<ng-template #spinner>
    <mat-spinner class="spinner" color="primary"></mat-spinner>
</ng-template>