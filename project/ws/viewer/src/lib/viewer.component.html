<div class="pt-0">
  <section *ngIf="isNotEmbed">
    <viewer-viewer-top-bar *ngIf="fullScreenContainer" [forPreview]="forPreview" [showFullScreenButton]="false" [frameReference]="fullScreenContainer"
      (toggle)="toggleSideBar()">
    </viewer-viewer-top-bar>
    <viewer-viewer-top-bar *ngIf="!fullScreenContainer" [showFullScreenButton]="false" [forPreview]="forPreview" [frameReference]="fullScreenContainer"
      (toggle)="toggleSideBar()">
    </viewer-viewer-top-bar>
    <section class="px-8 stickprop">
      <ng-container>
        <div class="isMobile">
           <button *ngIf="snav?.opened" mat-icon-button aria-label="Navbar Toggle button" color="primary" class="toggleBtn side-nav-button-opened btn-reverse" (click)="snav?.toggle()">
            <mat-icon class="dehaze-icon reverse" >double_arrow</mat-icon>
          </button>
          <!-- <button *ngIf="!snav?.opened" mat-icon-button aria-label="Navbar Toggle button" color="primary" class="toggleBtn side-nav-button-closed" (click)="snav?.toggle()">
            <mat-icon class="dehaze-icon">double_arrow</mat-icon>
          </button> -->
        </div>
        <mat-sidenav-container autosize class="viewer-sidenav-container playerTypeVideo">
            <mat-sidenav #snav [ngClass]="isTypeOfCollection ? 'viewer-sidenav':'viewer-sidenav-standalone'"
            [opened]="sideNavBarOpened" [mode]="mode" class="sidenav-effect"
            >
            <viewer-viewer-toc [forPreview]="forPreview" (hidenav)="minimizeBar()" [technicalResource]="technicalResource" (techResourceChange)="updateViewURL($event)"
            [discussionForumWidget]="discussionForumWidgetWithComment" (discussionForumEvent)="discussionForumEvent($event)">
            </viewer-viewer-toc>
          </mat-sidenav>
          <!-- <div>
            <ng-container [wsResolverWidget]="discussionForumWidgetWithComment"></ng-container>
          </div> -->
          <mat-sidenav-content class="sidenavContent" #scrollableContent  [ngClass]="{'sideNavOpend':snav?.opened}">
            <button *ngIf="snav?.opened" mat-icon-button aria-label="Navbar Toggle button" color="primary" class="toggleBtn side-nav-button-opened" (click)="snav?.toggle()">
              <mat-icon class="dehaze-icon reverse" >double_arrow</mat-icon>
            </button>
            <button *ngIf="!snav?.opened" mat-icon-button aria-label="Navbar Toggle button" color="primary" class="toggleBtn side-nav-button-closed" (click)="snav?.toggle()">
              <mat-icon class="dehaze-icon">double_arrow</mat-icon>
            </button>
            <div class="share-button">
              <ws-widget-btn-content-share [forPreview]="forPreview" [overview]="true" [widgetData]="content" [isDisabled]="isPreviewMode">
              </ws-widget-btn-content-share>
            </div>
            <ng-container *ngTemplateOutlet="mainContentTemplate; context: {navStatus:snav?.opened}"></ng-container>
          </mat-sidenav-content>
        </mat-sidenav-container>
      </ng-container>
      <!-- <ng-container *ngIf="!isTypeOfCollection && !technicalResource">
        <ng-container *ngTemplateOutlet="mainContentTemplate"></ng-container>
      </ng-container> -->
    </section>
    <section id='chat-window' class="px-8 py-6" *ngIf="toggleChatWindow">
      <div class="wrapper flex-none md:flex md:flex-row-reverse discussionforum md:mr-3" [ngClass]="{'guest-view': configService.isGuestUser === true}">
        <div class="w-full section-left dfcard lg:px-64" *ngIf="!configService.isGuestUser">
          <div *ngIf="!configService?.isGuestUser" class="video-discussion-forum-in margin-top-m margin-bottom-m lg:px-20">
              <h2 class="discussion-head font-montserrat body-font-size-primary space text-decoration-line cursor-pointer" (click)="toggleCommentWindow()">Show less</h2>
            <ng-container [wsResolverWidget]="discussionForumWidget"></ng-container>
          </div>
        </div>
      </div>
    </section>
  </section>
  <div class="full-height-width-iframe" *ngIf="!isNotEmbed">
    <router-outlet></router-outlet>
  </div>
  <div class="comments-mobile-view">
    <section id='chat-window' class="px-8 py-6">
      <div class="wrapper flex-none md:flex md:flex-row-reverse discussionforum md:mr-3">
        <div class="w-full section-left dfcard lg:px-64">
          <div class="video-discussion-forum-in margin-top-m margin-bottom-m lg:px-20">
            <ng-container [wsResolverWidget]="discussionForumWidget"></ng-container>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<!--Template logics-->
<ng-template #mainContentTemplate let-navStatus="navStatus">
  <section *ngIf="status === 'error'">
    <div *ngIf="errorWidgetData?.widgetData?.errorType" [wsResolverWidget]="errorWidgetData"></div>
    <div *ngIf="error.errorType === errorType.mimeTypeMismatch">
      <mat-card>
        <mat-card-title i18n>Looks like we are having some issues in our content.</mat-card-title>
        <mat-card-content>
          <div class="mat-caption">
            <ng-container i18n>
              Debug Message: This content is of a different mimeType (
            </ng-container>
            <ng-container>
              {{ error?.mimeType }}
            </ng-container>
            <ng-container i18n>
              )
            </ng-container>
          </div>
          <div>
            <strong i18n>Possible Link: </strong>
            <a [routerLink]="error.probableUrl">
              {{ error.probableUrl }}
            </a>
          </div>
          <div class="margin-top-m text-center">
            <a class="ws-mat-primary-text" [routerLink]="'/feedback/bug'" i18n>Report to us</a>
            <span i18n> and we will make it work</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div *ngIf="error.errorType === errorType.previewUnAuthorised">
      <mat-card class="margin-m">
        <mat-card-title i18n>Looks like you are not authorized to preview this content.</mat-card-title>
        <mat-card-content>
          <div>
            <a class="ws-mat-primary-text" [routerLink]="'/feedback/bug'" i18n>Report to us</a>
            <span i18n> and we will make it work</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </section>
  <section *ngIf="status === 'pending'">
    <mat-spinner></mat-spinner>
  </section>
  <ng-container *ngIf="!configService?.isGuestUser">
    <!-- <div class="chat-container" *ngIf="!navStatus">
      <ng-container [wsResolverWidget]="discussionForumWidgetWithComment" (someEvent)="discussionForumEvent($event)"></ng-container>
    </div> -->
    <router-outlet (activate)="getContentData($event)"></router-outlet>
  </ng-container>
  <ng-container *ngIf="configService?.isGuestUser">
    <ws-public-share-view (guestData)="getContentData($event, true)"></ws-public-share-view>
  </ng-container>
</ng-template>